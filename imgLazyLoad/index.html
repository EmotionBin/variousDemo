<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>imgLazyLoad demo</title>
  <style>
    *{
      margin: 0;
    }
    body{
      background-color: #ecf0f1;
    }
    h1{
      text-align: center;
      margin: 10px 0;
    }
    img {
      display: block;
      margin: 50px auto;
      width: 400px;
      height: 400px;
    }
  </style>
</head>
<body>
  <h1>å®ç°å›¾ç‰‡æ‡’åŠ è½½ğŸ˜</h1>
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=1" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=2" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=3" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=4" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=5" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=6" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=7" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=8" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=9" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=10" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=11" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=12" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=13" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=14" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=15" alt="">
  <img src="default.jpg" data-src="https://picsum.photos/400/400?random=16" alt="">
</body>
<script type="text/javascript">
  //æ€è·¯:
  //ç›‘å¬æ»šåŠ¨ï¼Œæ»šåŠ¨æ—¶å…ˆè§¦å‘èŠ‚æµå‡½æ•°ï¼Œç”±èŠ‚æµå‡½æ•°è§¦å‘å›¾ç‰‡æ‡’åŠ è½½å‡½æ•°
  //å›¾ç‰‡æ‡’åŠ è½½å‡½æ•°æ ¸å¿ƒï¼šåˆ¤æ–­æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨è·ç¦»ä¸å½“å‰å¯è§åŒºåŸŸé«˜åº¦çš„å’Œå¤§äºå›¾ç‰‡è·ç¦»é¡¶éƒ¨çš„è·ç¦»åˆ™åŠ è½½å›¾ç‰‡
  //å›¾ç‰‡æ‡’åŠ è½½å‡½æ•°å…·ä½“å®ç°ï¼š
  //åªæœ‰å›¾ç‰‡çš„srcå±æ€§æ˜¯ä¸€ä¸ªå¯è®¿é—®çš„é“¾æ¥æ—¶æ‰ä¼šåŠ è½½å›¾ç‰‡ï¼Œåˆå§‹æ—¶å›¾ç‰‡srcé»˜è®¤éšæ„æŒ‡å®šï¼Œå¹¶ç»™å›¾ç‰‡æ ‡ç­¾ç»‘å®šä¸Šdata-srcå±æ€§ï¼Œè¿™ä¸ªå€¼æ˜¯å›¾ç‰‡çš„é“¾æ¥
  //å½“æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨è·ç¦»ä¸å½“å‰å¯è§åŒºåŸŸé«˜åº¦çš„å’Œå¤§äºå›¾ç‰‡è·ç¦»é¡¶éƒ¨çš„è·ç¦»æ—¶ï¼ŒæŠŠå›¾ç‰‡çš„srcå±æ€§ç”¨data-srcå±æ€§æ›¿æ¢,æ­¤æ—¶å›¾ç‰‡æ‰å¼€å§‹çœŸæ­£çš„åŠ è½½
  const imgDom = document.getElementsByTagName('img');
  var num = imgDom.length;
  var n = 0; //å­˜å‚¨å›¾ç‰‡åŠ è½½åˆ°çš„ä½ç½®ï¼Œé¿å…æ¯æ¬¡éƒ½ä»ç¬¬ä¸€å¼ å›¾ç‰‡å¼€å§‹éå†
  lazyload(); //é¡µé¢è½½å…¥å®Œæ¯•åŠ è½½å¯è§†åŒºåŸŸå†…çš„å›¾ç‰‡
  function lazyload() { //ç›‘å¬é¡µé¢æ»šåŠ¨äº‹ä»¶
    var seeHeight = document.documentElement.clientHeight; //å¯è§åŒºåŸŸé«˜åº¦
    var scrollTop = document.documentElement.scrollTop || document.body.scrollTop; //æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨é«˜åº¦
    for (var i = n; i < num; i++) {
      if (imgDom[i].offsetTop < seeHeight + scrollTop) {
        if (imgDom[i].getAttribute("src") == "default.jpg") {
          imgDom[i].src = imgDom[i].getAttribute("data-src");
        }
        n = i + 1;
      }
    }
  }
  // ç®€å•çš„èŠ‚æµå‡½æ•°
  //fun è¦æ‰§è¡Œçš„å‡½æ•°
  //delay å»¶è¿Ÿ
  //time  åœ¨timeæ—¶é—´å†…å¿…é¡»æ‰§è¡Œä¸€æ¬¡
  function throttle(fun, delay, time) {
    var timeout,
    startTime = new Date();
    return function() {
      var context = this,
      args = arguments,
      curTime = new Date();
      clearTimeout(timeout);
      // å¦‚æœè¾¾åˆ°äº†è§„å®šçš„è§¦å‘æ—¶é—´é—´éš”ï¼Œè§¦å‘ handler
      if (curTime - startTime >= time) {
        fun.apply(context, args);
        startTime = curTime;
        // æ²¡è¾¾åˆ°è§¦å‘é—´éš”ï¼Œé‡æ–°è®¾å®šå®šæ—¶å™¨
      } else {
        timeout = setTimeout(fun, delay);
      }
    };
  };
  // é‡‡ç”¨äº†èŠ‚æµå‡½æ•°
  window.addEventListener('scroll',throttle(lazyload,500,1000));
</script>
</html>